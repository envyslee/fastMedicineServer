
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>test</title>
<style type="text/css">
li {
	line-height: 150%;
	font-size: 18px
}
</style>
<script type="text/javascript" src="script/jquery-1.4.4.min.js"></script>
</head>
<body>
	<script type="text/javascript">
		function test(id) {
			var partner = $("#partner").val();
			var sessionkey = $("#sessionkey").val();
			//var partner =1;
			//var sessionkey =2;
			var accesstoken = $("#accesstoken").val();
			var orderId = $("#order_id").val();
			var custid = $("#cust_id").val();
			if (partner == "" || sessionkey == "" || accesstoken == "") {
				alert("请先获取token");
				return false;
			}
			//模拟一期
			if (id == "SimulationByMonth") {
				var amount = $("#apply_amount").val();
				var interestrate = $("#day_interestrate").val();
				if (amount == "") {
					alert("请输入申请金额");
					$("#apply_amount").select();
					return false;
				}
				if (interestrate == "") {
					alert("请输入日率");
					$("#day_interestrate").select();
					return false;
				}
				var href = "PreLoan/SimulationByMonth/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + amount + "/"
						+ interestrate + "/";
				$("#SimulationByMonth").attr("href", href);
			}
			//订单详情
			else if (id == "QueryOrderDetail") {
				if (orderId == "") {
					alert("请输入合作方订单id");
					$("#order_id").select();
					return false;
				}
				var href = "Order/QueryOrderDetail/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + orderId + "/";
				$("#QueryOrderDetail").attr("href", href);
			}
			//模拟多期
			else if (id == "SimulationByMonths") {
				var amount = $("#apply_amounts").val();
				var interestrate = $("#day_interestrates").val();
				var applyperiod = $("#apply_period").val();
				var href = "PreLoan/SimulationByMonths/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + amount + "/"
						+ applyperiod + "/" + interestrate + "/";
				$("#SimulationByMonths").attr("href", href);
			}
			//查询正在进行中的订单
			else if (id == "QueryDoingOrder") {
				if (custid == "") {
					alert("请输入合作方客户id");
					$("#cust_id").select();
					return false;
				}
				var href = "Order/QueryDoingOrder/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + custid + "/";
				$("#QueryDoingOrder").attr("href", href);
			}
			//查询所有订单
			else if (id == "QueryAllOrder") {
				if (custid == "") {
					alert("请输入合作方客户id");
					$("#cust_id").select();
					return false;
				}
				var href = "Order/QueryAllOrder/" + partner + "/" + sessionkey
						+ "/" + accesstoken + "/" + custid + "/";
				$("#QueryAllOrder").attr("href", href);
			}
			//查询已出账单信息
			else if (id == "QueryBillRecord") {
				if (orderId == "") {
					alert("请输入合作方订单id");
					$("#order_id").select();
					return false;
				}
				var href = "PostLoan/QueryBillRecord/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + orderId + "/";
				$("#QueryBillRecord").attr("href", href);
			}
			//获取订单账单
			else if (id == "QueryRepaySchedule") {
				if (orderId == "") {
					alert("请输入合作方订单id");
					$("#order_id").select();
					return false;
				}
				var href = "Order/QueryRepaySchedule/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + orderId + "/";
				$("#QueryRepaySchedule").attr("href", href);
			}
			//一期提前还款
			else if (id == "PreRepayByMonth") {
				if (orderId == "") {
					alert("请输入合作方订单id");
					$("#order_id").select();
					return false;
				}
				var href = "PostLoan/PreRepayByMonth/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + orderId + "/";
				$("#PreRepayByMonth").attr("href", href);
			}
			//多期提前还款
			else if (id == "PreRepayByMonths") {
				if (orderId == "") {
					alert("请输入合作方订单id");
					$("#order_id").select();
					return false;
				}
				var href = "PostLoan/PreRepayByMonths/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + orderId + "/";
				$("#PreRepayByMonths").attr("href", href);
			}
			//查询客户额度
			else if (id == "QueryLimit") {
				if (custid == "") {
					alert("请输入合作方客户id");
					$("#cust_id").select();
					return false;
				}
				var href = "Customer/Cash_CustCredit/" + partner + "/"
						+ sessionkey + "/" + accesstoken + "/" + custid + "/";
				$("#QueryLimit").attr("href", href);
			}

		}
		//绑定银行卡
		function bind() {
			var partner = $("#partner").val();
			var sessionkey = $("#sessionkey").val();
			var accesstoken = $("#accesstoken").val();
			var custid = $("#cust_idb").val();
			var cardholder = $("#card_holder").val();
			var cardno = $("#card_no").val();
			var cardbank = $("#card_bank").val();
			if (isNaN(cardbank)) {
				alert("错误：银行枚举必须为数字！");
				return;
			}
			$.ajax({
				//提交数据的类型 POST GET
				type : "POST",
				//提交的网址
				url : "Customer/BindBankCard",
				//提交的数据
				data : {
					partner : partner,
					sessionkey : sessionkey,
					accesstoken : accesstoken,
					cust_id : custid,
					card_holder : cardholder,
					card_no : cardno,
					card_bank : cardbank
				},
				//返回数据的格式
				datatype : "html",//"xml","html", "script", "json", "jsonp", "text".
				success : function(data) {
					alert(data.rescode + ":" + data.resmsg);
					//alert("绑定成功");
				},
				//调用执行后调用的函数
				complete : function(XMLHttpRequest, textStatus) {
					// alert(XMLHttpRequest.responseText);
					//alert(textStatus);
				},
				//调用出错执行的函数
				error : function(XMLHttpRequest, textStatus, errorThrown) {
					alert("绑定失败,请求出错");
					//请求出错处理
				}
			});
		}
		//提交申请
		function apply() {
			var partner = $("#partner").val();
			var sessionkey = $("#sessionkey").val();
			var accesstoken = $("#accesstoken").val();

			var orderida = $("#order_ida").val();
			var custida = $("#cust_ida").val();
			var custnamea = $("#cust_namea").val();
			var custidcarda = $("#cust_idcarda").val();
			var custmobilea = $("#cust_mobilea").val();
			var applyamounta = $("#apply_amounta").val();
			var applyperioda = $("#apply_perioda").val();
			var repayreminda = $("#repay_reminda").val();
			var loantimea = $("#loan_timea").val();

			$.ajax({
				type : "POST",
				url : "PreLoan/Cash_ApplyLoan",
				data : {
					partner : partner,
					sessionkey : sessionkey,
					accesstoken : accesstoken,
					order_id : orderida,
					cust_id : custida,
					cust_name : custnamea,
					cust_idcard : custidcarda,
					cust_mobile : custmobilea,
					apply_amount : applyamounta,
					apply_period : applyperioda,
					repay_remind : repayreminda,
					loan_time : loantimea
				},
				datatype : "json",
				success : function(data) {
					if (data.rescode == "001") {
						alert(data.rescode + ":" + data.resmsg + "/n"
								+ "维信订单id:" + data.content.vcredit_orderid
								+ "/n" + "可用额度:"
								+ data.content.available_credit);
					} else {
						alert(data.rescode + ":" + data.resmsg);
					}
				},
				error : function() {
					alert("绑定失败,请求出错");
				}

			});
		}
		//获取token
		function getToken() {
			var partner = $("#partner").val();
			var pwd = $("#partnerpwd").val();
			var sessionkey = $("#sessionkey").val();
			if (partner.length == 0 || pwd.length == 0
					|| sessionkey.length == 0) {
				alert("参数为空");
				return;
			}
			var href = "Auth/QueryAccesstoken/" + partner + "/" + pwd + "/"
					+ sessionkey + "/";
			$.ajax({
				type : "GET",
				url : href,
				datatype : "json",
				success : function(data) {
					alert(data.rescode + ":" + data.resmsg);
					$("#accesstoken").val(data.content.accesstoken);
					$("#expiretime").val(data.content.expire_date);
				},
				error : function() {
					alert("请求出错");
				}
			})
		}
		//是否可以提现
		function canApply() {
			var partner = $("#partner").val();
			var sessionkey = $("#sessionkey").val();
			var accesstoken = $("#accesstoken").val();

			var cusid = $("#cust_idc").val();
			var amount = $("#apply_amountc").val();

			$.ajax({
				type : "POST",
				url : "PreLoan/Cash_CanApply",
				data : {
					partner : partner,
					sessionkey : sessionkey,
					accesstoken : accesstoken,
					cust_id : cusid,
					apply_amount : amount
				},
				datatype : "json",
				success : function(data) {
					alert(data.rescode + ":" + data.resmsg);
				},
				error : function() {
					alert("请求出错");
				}
			})
		}
	</script>


	<ul>
		<li><input id="QueryAccessToken" onclick="getToken()"
			type="button" value="获取token" /> <input id="partner" type="text"
			style="width: 100px" placeholder="合作方id" /> <input id="partnerpwd"
			type="text" style="width: 100px" placeholder="合作方密码" /> <input
			id="sessionkey" type="text" style="width: 100px" placeholder="操作唯一标识" />
			<br /> 访问令牌<input type="text" id="accesstoken" readonly
			style="width: 250px"> 过期时间<input type="text" id="expiretime"
			readonly style="width: 150px"></li>
	</ul>
	<ul>
		<li><a id="SimulationByMonth" href="javascript:void(0);"
			onclick="test(this.id);" target="_blank">模拟一期</a> 申请金额<input
			type="text" id="apply_amount" style="width: 100px"> 日率<input
			type="text" id="day_interestrate" style="width: 100px"></li>
		<li><a id="SimulationByMonths" href="javascript:void(0);"
			onclick="test(this.id);" target="_blank">模拟多期</a> 申请金额<input
			type="text" id="apply_amounts" style="width: 100px"> 月率<input
			type="text" id="day_interestrates" style="width: 100px"> 申请期限<input
			type="text" id="apply_period" style="width: 100px"></li>

	</ul>
	<br> 合作方客户id
	<input type="text" id="cust_id" style="width: 100px">
	<br>
	<ul>
		<li><a id="QueryDoingOrder" href="javascript:void(0);"
			onclick="test(this.id);" target="_blank">查询正在进行中的订单</a></li>
		<li><a id="QueryAllOrder" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank">查询所有订单</a></li>

		<li><a id="QueryLimit" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank"> 查询额度</a></li>
	</ul>
	<br> 合作方订单id
	<input type="text" id="order_id" style="width: 100px">
	<br>
	<ul>
		<li><a id="QueryOrderDetail" href="javascript:void(0);"
			onclick="test(this.id);" target="_blank">订单详情</a></li>
		<li><a id="QueryBillRecord" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank"> 查询已出账单信息</a></li>
		<li><a id="QueryRepaySchedule" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank">获取订单账单</a></li>
		<li><a id="PreRepayByMonth" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank">一期提前还款</a></li>
		<li><a id="PreRepayByMonths" href="javascript:void(0);"
			onclick="test(this.id)" target="_blank">多期提前还款</a></li>
	</ul>
	<br>post
	<ul>
	
		<li><input type="button" value="绑定银行卡" onclick="bind();">
			<br> <input id="cust_idb" placeholder="合作方客户id"> <input
			id="card_holder" placeholder="持卡人姓名"> <input id="card_no"
			placeholder="卡号"> <input id="card_bank"
			placeholder="银行枚举（数字）"></li>
		<li><input type="button" value="提现申请" onclick="apply()">
			<br> <input id="order_ida" placeholder="合作方订单id"> <input
			id="cust_ida" placeholder="合作方客户id"> <input id="cust_namea"
			placeholder="客户姓名"> <input id="cust_idcarda"
			placeholder="客户身份证"> <input id="cust_mobilea"
			placeholder="客户手机号"> <input id="apply_amounta"
			placeholder="申请金额"> <input id="apply_perioda"
			placeholder="申请期限"> <input id="repay_reminda"
			placeholder="是否需要还款提醒"> <input id="loan_timea"
			placeholder="放款时间"></li>
		<li><input type="button" value="是否可以提现" onclick="canApply()" /> <br>
			<input id="cust_idc" placeholder="合作方客户id" /> <input
			id="apply_amountc" placeholder="申请金额" /></li>
	</ul>

</body>
</html>